"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8113],{1954:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var s=n(4848),i=n(8453);const a={id:"docusaurus-search",slug:"/docusaurus-search",title:"Search",authors:"kuizuo"},t=void 0,o={id:"skiill/docusaurus/docusaurus-search",title:"Search",description:"Search | Docusaurus",source:"@site/docs/skiill/docusaurus/search.md",sourceDirName:"skiill/docusaurus",slug:"/docusaurus-search",permalink:"/docu/docs/docusaurus-search",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/skiill/docusaurus/search.md",tags:[],version:"current",frontMatter:{id:"docusaurus-search",slug:"/docusaurus-search",title:"Search",authors:"kuizuo"},sidebar:"tutorialSidebar",previous:{title:"Plugins",permalink:"/docu/docs/docusaurus-plugin"},next:{title:"Styles and Pages",permalink:"/docu/docs/docusaurus-style"}},c={},l=[{value:"Algolia",id:"algolia",level:2},{value:"Option 1",id:"option-1",level:3},{value:"\u65b9\u68482",id:"\u65b9\u68482",level:3},{value:"orama",id:"orama",level:2},{value:"Local Search",id:"local-search",level:2}];function u(e){const r={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://docusaurus.io/docs/search",children:"Search | Docusaurus"})}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"algolia",children:(0,s.jsx)(r.a,{href:"https://www.algolia.com/",children:"Algolia"})}),"\n",(0,s.jsx)(r.p,{children:"There are two options for configuring Algolia."}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["Let Docsearch (specifically, ",(0,s.jsx)(r.a,{href:"https://crawler.algolia.com/",children:"Algolia Crawler"}),") crawl your website weekly (or you can manually trigger crawling). ",(0,s.jsx)(r.strong,{children:"This is free only if your project is open source; otherwise, it\u2019s a paid service"}),". The advantage is that no additional configuration is needed, although applying for this service can be cumbersome (the method used by this blog)."]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"Run your own DocSearch crawler, which allows you to crawl your site anytime but requires setting up an account and a crawling environment yourself, or you can use GitHub Actions to automate the crawling."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"option-1",children:"Option 1"}),"\n",(0,s.jsxs)(r.p,{children:["The application process for Algolia DocSearch is detailed in the documentation. It involves a lengthy application process that requires email verification and confirmation from Algolia. While the conditions for free hosting by DocSearch are quite stringent, it is almost a one-time setup if successful, and it is highly recommended. If approved, you can view the crawler status in the ",(0,s.jsx)(r.a,{href:"https://crawler.algolia.com/admin/crawlers",children:"Crawler Admin Console"}),"."]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.kuizuo.cn/image-20220627232545640.png",alt:"image-20220627232545640"})}),"\n",(0,s.jsxs)(r.p,{children:["Then, enter the Algolia ",(0,s.jsx)(r.code,{children:"appId"}),", ",(0,s.jsx)(r.code,{children:"apiKey"}),", and ",(0,s.jsx)(r.code,{children:"indexName"})," into your ",(0,s.jsx)(r.code,{children:"docusaurus.config.ts"}),"."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-javascript",metastring:"title='docusaurus.config.ts'",children:"algolia: {\r\n  appId: 'GV6YN1ODMO',\r\n  apiKey: '50303937b0e4630bec4a20a14e3b7872',\r\n  indexName: 'vnambs',\r\n}\r\n\n"})}),"\n",(0,s.jsx)(r.p,{children:"After crawling, Algolia will also send periodic updates to your email."}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.kuizuo.cn/image-20230219144035031.png",alt:"image-20230219144035031"})}),"\n",(0,s.jsx)(r.h3,{id:"\u65b9\u68482",children:"\u65b9\u68482"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://docsearch.algolia.com/docs/run-your-own",children:"Run your own | DocSearch (algolia.com)"})}),"\n",(0,s.jsx)(r.p,{children:"Because Option 1 is often difficult to obtain and may fail, Option 2 becomes necessary."}),"\n",(0,s.jsxs)(r.p,{children:["First, apply for an ",(0,s.jsx)(r.a,{href:"https://www.algolia.com/",children:"Algolia"}),' account, then create an index under the left menu "indices" and get the Application ID and API Key (note that there are two API Keys).']}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.kuizuo.cn/image-20210821230135749.png",alt:"image-20210821230135749"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.kuizuo.cn/image-20210821230232837.png",alt:"image-20210821230232837"})}),"\n",(0,s.jsxs)(r.p,{children:["he API Key you need to enter in ",(0,s.jsx)(r.code,{children:"docusaurus.config.ts"})," is the Search-Only API Key."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:'themeConfig: {\r\n    algolia: {\r\n      apiKey: "xxxxxxxxxxx",\r\n      appId: "xxxxxxxxxxx",\r\n      indexName: "kuizuo",\r\n    },\r\n}\n'})}),"\n",(0,s.jsxs)(r.p,{children:["I use Linux and run the crawler code in a Docker environment. First, ",(0,s.jsx)(r.a,{href:"https://github.com/stedolan/jq/wiki/Installation#zero-install",children:"install jq"})," (I used 0install for installation, which may be a bit slow), then verify the installation in the console."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"[root@vnserver xxxx.com]# jq --version\r\njq-1.6\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Next, create a ",(0,s.jsx)(r.code,{children:".env"})," file in any directory and enter the corresponding APPID and API KEY (here it should be the ",(0,s.jsx)(r.code,{children:"Admin API Key"}),", which I mistakenly thought was the Search API Key \ud83d\ude2d)."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"APPLICATION_ID = YOUR_APP_ID\r\nAPI_KEY = YOUR_API_KEY\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Create a ",(0,s.jsx)(r.code,{children:"docsearch.json"})," file in your project directory with content similar to this (replace highlighted parts with your website information)."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-json",metastring:"title='docsearch.json' {2-4}",children:'{\r\n  "index_name": "xxxx",\r\n  "start_urls": ["https://example.com"],\r\n  "sitemap_urls": ["https://example.com"],\r\n  "selectors": {\r\n    "lvl0": {\r\n      "selector": "(//ul[contains(@class,\'menu__list\')]//a[contains(@class, \'menu__link menu__link--sublist menu__link--active\')]/text() | //nav[contains(@class, \'navbar\')]//a[contains(@class, \'navbar__link--active\')]/text())[last()]",\r\n      "type": "xpath",\r\n      "global": true,\r\n      "default_value": "Documentation"\r\n    },\r\n    "lvl1": "header h1, article h1",\r\n    "lvl2": "article h2",\r\n    "lvl3": "article h3",\r\n    "lvl4": "article h4",\r\n    "lvl5": "article h5, article td:first-child",\r\n    "lvl6": "article h6",\r\n    "text": "article p, article li, article td:last-child"\r\n  },\r\n  "custom_settings": {\r\n    "attributesForFaceting": ["type", "lang", "language", "version", "docusaurus_tag"],\r\n    "attributesToRetrieve": ["hierarchy", "content", "anchor", "url", "url_without_anchor", "type"],\r\n    "attributesToHighlight": ["hierarchy", "content"],\r\n    "attributesToSnippet": ["content:10"],\r\n    "camelCaseAttributes": ["hierarchy", "content"],\r\n    "searchableAttributes": [\r\n      "unordered(hierarchy.lvl0)",\r\n      "unordered(hierarchy.lvl1)",\r\n      "unordered(hierarchy.lvl2)",\r\n      "unordered(hierarchy.lvl3)",\r\n      "unordered(hierarchy.lvl4)",\r\n      "unordered(hierarchy.lvl5)",\r\n      "unordered(hierarchy.lvl6)",\r\n      "content"\r\n    ],\r\n    "distinct": true,\r\n    "attributeForDistinct": "url",\r\n    "customRanking": ["desc(weight.pageRank)", "desc(weight.level)", "asc(weight.position)"],\r\n    "ranking": ["words", "filters", "typo", "attribute", "proximity", "exact", "custom"],\r\n    "highlightPreTag": "<span class=\'algolia-docsearch-suggestion--highlight\'>",\r\n    "highlightPostTag": "</span>",\r\n    "minWordSizefor1Typo": 3,\r\n    "minWordSizefor2Typos": 7,\r\n    "allowTyposOnNumericTokens": false,\r\n    "minProximity": 1,\r\n    "ignorePlurals": true,\r\n    "advancedSyntax": true,\r\n    "attributeCriteriaComputedByMinProximity": true,\r\n    "removeWordsIfNoResults": "allOptional",\r\n    "separatorsToIndex": "_",\r\n    "synonyms": [\r\n      ["js", "javascript"],\r\n      ["ts", "typescript"]\r\n    ]\r\n  }\r\n}\n'})}),"\n",(0,s.jsx)(r.p,{children:"Run the Docker command:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'docker run -it --env-file=.env -e "CONFIG=$(cat docsearch.json | jq -r tostring)" algolia/docsearch-scraper\n'})}),"\n",(0,s.jsx)(r.p,{children:"Wait for the container to run and crawl your site. If you see the success page in the Algolia console, it means it worked."}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.kuizuo.cn/image-20210821225934002.png",alt:"image-20210821225934002"})}),"\n",(0,s.jsx)(r.p,{children:"To ensure the project is deployed before triggering, you can use the following trigger conditions if deploying with Vercel."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-yaml",metastring:"title='.github/workflows/docsearch.yml'",children:'name: docsearch\r\n\r\non: deployment\r\n\r\njobs:\r\n  algolia:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - uses: actions/checkout@v2\r\n\r\n      - name: Get the content of docsearch.json as config\r\n        id: algolia_config\r\n        run: echo "::set-output name=config::$(cat docsearch.json | jq -r tostring)"\r\n\r\n      - name: Run algolia/docsearch-scraper image\r\n        env:\r\n          ALGOLIA_APP_ID: ${{ secrets.ALGOLIA_APP_ID }}\r\n          ALGOLIA_API_KEY: ${{ secrets.ALGOLIA_API_KEY }}\r\n          CONFIG: ${{ steps.algolia_config.outputs.config }}\r\n        run: |\r\n          docker run \\\r\n            --env APPLICATION_ID=${ALGOLIA_APP_ID} \\\r\n            --env API_KEY=${ALGOLIA_API_KEY} \\\r\n            --env "CONFIG=${CONFIG}" \\\r\n            algolia/docsearch-scraper\n'})}),"\n",(0,s.jsxs)(r.p,{children:["Add ",(0,s.jsx)(r.a,{href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository",children:"secrets"}),"  to your GitHub repository, and pushing code will trigger the crawling rules."]}),"\n",(0,s.jsx)(r.h2,{id:"orama",children:(0,s.jsx)(r.a,{href:"https://docs.oramasearch.com/open-source/plugins/plugin-docusaurus",children:"orama"})}),"\n",(0,s.jsxs)(r.p,{children:["If you find the Algolia application process cumbersome, you can integrate ",(0,s.jsx)(r.a,{href:"https://docs.oramasearch.com/open-source/plugins/plugin-docusaurus",children:"orama"})," into Docusaurus. Orama provides full-text, vector, and hybrid search query services running in browsers, servers, and at the edge. The final result looks like this:"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.kuizuo.cn/2024/0118082834-202401180828818.png",alt:""})}),"\n",(0,s.jsx)(r.h2,{id:"local-search",children:"Local Search"}),"\n",(0,s.jsx)(r.p,{children:"If you find Algolia's application process too complicated, Docusaurus also offers a local search option, though it is less powerful compared to full-text search."}),"\n",(0,s.jsxs)(r.p,{children:["Local search plugin:",(0,s.jsx)(r.a,{href:"https://github.com/cmfcmf/docusaurus-search-local",children:"docusaurus-search-local"})]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>t,x:()=>o});var s=n(6540);const i={},a=s.createContext(i);function t(e){const r=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);