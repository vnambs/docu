"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1468],{3233:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>u});var o=i(4848),t=i(8453);const s={id:"docusaurus-deploy",slug:"/docusaurus-deploy",title:"Deployment",authors:"vnambs"},r=void 0,a={id:"skiill/docusaurus/docusaurus-deploy",title:"Deployment",description:"Previously, I used Vercel for deployment with minimal configuration. This allowed me to focus solely on content creation. You can check out my article on deploying with Vercel here.",source:"@site/docs/skiill/docusaurus/deploy.md",sourceDirName:"skiill/docusaurus",slug:"/docusaurus-deploy",permalink:"/docu/docs/docusaurus-deploy",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/skiill/docusaurus/deploy.md",tags:[],version:"current",frontMatter:{id:"docusaurus-deploy",slug:"/docusaurus-deploy",title:"Deployment",authors:"vnambs"},sidebar:"tutorialSidebar",previous:{title:"Configuration File",permalink:"/docu/docs/docusaurus-config"},next:{title:"Customizing Docusaurus Themes",permalink:"/docu/docs/docusaurus-guides"}},c={},u=[{value:"Continuous Integration",id:"continuous-integration",level:2},{value:"Deploying Without a Domain or Server",id:"deploying-without-a-domain-or-server",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Previously, I used ",(0,o.jsx)(n.a,{href:"https://vercel.com",children:"Vercel"})," for deployment with minimal configuration. This allowed me to focus solely on content creation. You can check out my article on deploying with Vercel ",(0,o.jsx)(n.a,{href:"/docs/skill",children:"here"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["However, ",(0,o.jsx)(n.code,{children:"vercel.app"})," has been affected by DNS pollution, which means it is blocked in mainland China. Even though using a custom domain pointed to Vercel might work, the speed of DNS resolution for mainland China will inevitably slow down, affecting site performance."]}),"\n",(0,o.jsx)(n.p,{children:"To improve the visitor experience, I decided to use different resolution methods for domestic and international access. This involves configuring different records for domestic and international access, using a domestic CDN for domestic traffic and Vercel for international traffic."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://img.kuizuo.cn/image-20221204161431863.png",alt:"CDN Configuration"})}),"\n",(0,o.jsxs)(n.p,{children:["With this setup, visitors in mainland China will use the domestic CDN, while international visitors will use Vercel's CDN. This setup improves access speed for different regions. You can test your site\u2019s performance at ",(0,o.jsx)(n.a,{href:"https://www.ping.cn/",children:"Ping.cn: Website Speed Test"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Here are the results of my website speed tests, and you can also view them at ",(0,o.jsx)(n.a,{href:"https://www.ping.cn/http/kuizuo.cn",children:"kuizuo.cn National Speed Test - Ping.cn"}),"."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{src:"https://img.kuizuo.cn/image-20221204161146327.png",alt:"Speed Test Results"})}),"\n",(0,o.jsx)(n.h2,{id:"continuous-integration",children:"Continuous Integration"}),"\n",(0,o.jsx)(n.p,{children:"Since Vercel can automatically pull code from repositories and build and deploy it, minimal configuration is required."}),"\n",(0,o.jsxs)(n.p,{children:["For code pushed to a repository (like GitHub), a CI service is needed to handle these tasks. I use ",(0,o.jsx)(n.a,{href:"https://github.com/marketplace",children:"GitHub Actions"})," for this purpose. Build logs can be viewed in ",(0,o.jsx)(n.a,{href:"https://github.com/kuizuo/blog/actions",children:"Actions \xb7 kuizuo/blog"}),". Here is my configuration file:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",metastring:"title='.github/workflows/ci.yml' icon='logos:github-actions'",children:"name: CI\r\n\r\non:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ${{ matrix.os }}\r\n\r\n    strategy:\r\n      matrix:\r\n        os: [ubuntu-latest] # macos-latest, windows-latest\r\n        node: [18]\r\n\r\n    steps:\r\n      - uses: actions/checkout@v4\r\n\r\n      - name: Set node version to ${{ matrix.node-version }}\r\n        uses: actions/setup-node@v4\r\n        with:\r\n          node-version: ${{ matrix.node-version }}\r\n\r\n      - run: corepack enable\r\n\r\n      - name: Setup\r\n        run: npm i -g @antfu/ni\r\n\r\n      - name: Install\r\n        run: nci\r\n\r\n      - name: Build\r\n        run: nr build\r\n\r\n      - name: SSH Deploy\r\n        uses: easingthemes/ssh-deploy@v4.1.10\r\n        env:\r\n          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}\r\n          ARGS: '-avzr --delete'\r\n          SOURCE: 'build'\r\n          REMOTE_HOST: ${{ secrets.REMOTE_HOST }}\r\n          REMOTE_USER: 'root'\r\n          TARGET: '/opt/1panel/apps/openresty/openresty/www/sites/kuizuo.cn/index'\r\n\n"})}),"\n",(0,o.jsx)(n.p,{children:"Once CI finishes building the output, it will be deployed to the server via rsync, completing the deployment process."}),"\n",(0,o.jsx)(n.p,{children:"After configuring everything, I just push the code to the remote repository, and GitHub Actions and Vercel will handle their respective tasks. After a short wait, the newly pushed code will be live on the site."}),"\n",(0,o.jsx)(n.h2,{id:"deploying-without-a-domain-or-server",children:"Deploying Without a Domain or Server"}),"\n",(0,o.jsxs)(n.p,{children:["The above is my configuration setup. For those without their own domain or server and looking for a free option, I recommend ",(0,o.jsx)(n.a,{href:"https://www.netlify.com/",children:"Netlify"}),"\uff0c You can use Netlify\u2019s subdomain, such as ",(0,o.jsx)(n.code,{children:"https://yourname.netlify.app"}),"\uff0c and it will be deployed to Netlify\u2019s CDN. However, it is not recommended to use Netlify for production environments due to its limited bandwidth and other limitations."]}),"\n",(0,o.jsx)(n.p,{children:"This section covers deploying a Docusaurus site, including setting up CDN configurations for better performance in different regions, using CI/CD with GitHub Actions, and recommendations for those without a domain or server."})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var o=i(6540);const t={},s=o.createContext(t);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);